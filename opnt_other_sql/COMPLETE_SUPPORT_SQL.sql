-- TO CHECK THE SCRAPE COUNTS IN WSRL 

SELECT SCRAPE_TOPIC, COUNTRY_CODE, COUNT(1) FROM WEB_SCRAPE_RAW_L where SCRAPE_DATE >= CURRENT_DATE() - INTERVAL 1 DAY GROUP BY SCRAPE_TOPIC, COUNTRY_CODE ;
-- THEN CHECK THE DETAILS OF A SPECIFIC COMBO
SELECT * FROM WEB_SCRAPE_RAW_L WHERE SCRAPE_DATE >= CURRENT_DATE() - INTERVAL 1 DAY AND COUNTRY_CODE = 'USA' AND SCRAPE_TOPIC = 'SPORTS' ORDER BY ROW_ID DESC ;


-- TO COMPARE THE PROC LENGTH AND RECENCY - BETN PROD AND DEV AND TO COMPARE THE TABLE STRUCTURES

SELECT ROUTINE_TYPE, ROUTINE_NAME, LAST_ALTERED, LENGTH(ROUTINE_DEFINITION) RLEN FROM INFORMATION_SCHEMA.ROUTINES WHERE ROUTINE_SCHEMA = 'opntprod' ORDER BY 3 DESC LIMIT 30 ;
SELECT TABLE_NAME, COUNT(1) FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = 'opntprod' GROUP BY TABLE_NAME ORDER BY 1 DESC ;
SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'opntprod' ;
-- 